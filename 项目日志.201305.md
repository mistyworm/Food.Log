#2013年5月项目日志

##31日
1. 了解其它购物网站的订单、发货单之间关系。有的B2C支持分单（一份订单多次发货），C2C一般都是一份订单一次发货，二者经常混用。
2. 考虑先做一个简单版本支撑到七月初。因为当前部署版为了份额物流已经做了改动，流程实际上是不通的。暂时没有决定具体计划。


##30日
1. 针对package概念引入，需求从基于订单向基于包裹转移，产生很大工作量和复杂度。
2. FO改成P（Package），新增IsCold、IsIce、原有DeliveryNote。相应的FOID都改成PID。
3. 重写存储过程：
	1. createpaymentP（PID）：针对散购+新建包裹，根据PID创建货款和物流费支付信息，填PPayment表。
	2. createpaymentPI（PIID，PID）:针对散购+加入老包裹，创建货款和物流费附加的payment。
	3. createpaymentUNS（UNSID,DSID）：针对配送份额NS创建货款支付信息。并创建对应的P，如果某一次配送遇到现有P，则创建物流费附加的payment。其余P按照新建创建物流费payment，填PPayment、PaymentItem表。
4. 李宠波提出保留FO订单概念，增加Package包裹概念。而黄勇刚认为只要Package不需要保留FO。从业务概念上看FO没有存在的必要（还需实际开发验证），但页面的许多功能代码看，保留FO可能有好处。


1. 散购需求：
	1. 沿用清明版流程，少量修改以下几处。
	2. 消费者在222食品详情页购买后，数据存入购物车（用文件？）。
	3. 消费者在260页调整数量后，数据存入购物车（用文件？）。
	4. 消费者在261页选择ds+time创建或者加入包裹。
		* 如果是新建包裹，则创建p、pi。p.dstid还是空的。call createpaymentP（PID）创建payment、paymentitem、ppayment
		* 如果是加入老包裹，则创建pi，把老包裹的pid写入pi。call createpaymentPI（PIID，PID）生成追加物流费的payment、paymentitem、ppayment。

1. 份额需求：
	1. 沿用清明版流程，少量修改以下几处。
	2. 消费者在222食品详情页购买后，生成uns。
	3. 消费者在260页调整数量后，可能再生成多个uns。
	4. 消费者在261页，每个uns可以单独选择地址和ds。调用createpaymentUNS()。
	5. 份额每次配送消费者选菜或生产和配菜，写入PI。不产生对应payment。

1. 支付需求
	1. 262支付页，列出所有未支付款项payment。包括货款、物流费（新包裹、旧包裹增加货物两种情况都准确计算）。未支付款项的总额作为参数，生成支付宝按钮。
	2. 提示消费者立即确认到货。
	3. 确认到货之后，根据Payment对应的P去创建还不存在的dst、dsst，把dstid写入P，创建Pdsst。

##29日
1. 把现有的FO直接当做Package使用，表示一次发货的包裹。
3. 配送份额NS不再作为FOI的一项，而是单独的支付项目。FO取代UNST，表示一次配送的包裹。FOI取代UNSTI。表格属性都略有调整。
4. 删除UNST、UNSTI、UNSTDSST表。增加DSTDSST表。FODSST增加给送货人、取菜点看的备注，删除财务有关字段。
5. UNS增加PaymentID，FOI增加PaymentID，指向货款支付payment。FO的的PaymentID删除，增加FOP表，记录FO对应的物流费payment（因为FOI可以加入到已有的FO，物流费会不停增加）。
6. 重写存储过程：
	1. createpaymentFO（FOID）：针对散购+新建包裹，根据FO创建货款和物流费支付信息，填fop表。
	2. InsertFOI（FOIID，FOID）:针对散购+加入老包裹，创建货款和物流费附加的payment。
	3. createpaymentUNS（UNSID,DSID）：针对配送份额NS创建货款支付信息。并创建对应的FO，如果某一次配送遇到现有fo，则创建物流费附加的payment。其余fo按照新建创建物流费payment，填fop表。


1. 散购需求：
	1. 沿用清明版流程，少量修改以下几处。
	2. 消费者在222食品详情页购买后，生成foi。不生成fo，fdi的foid空着。
	3. 消费者在260页调整数量后，修改foi。
	4. 消费者在261页选择ds+time创建或者加入包裹。
		* 如果是新建包裹，则创建fo，foid写入foi。dstid还是空的。
		* 如果是加入老包裹，则把老包裹的foid写入foi。
		调用createpaymentfo()。

1. 份额需求：
	1. 沿用清明版流程，少量修改以下几处。
	2. 消费者在222食品详情页购买后，生成uns。
	3. 消费者在260页调整数量后，可能再生成多个uns。
	4. 消费者在261页，每个uns可以单独选择地址和ds。调用createpaymentUNS()。

1. 支付需求
	1. 262支付页，列出所有未支付款项payment。包括货款、物流费（新包裹、旧包裹增加货物两种情况都准确计算）。未支付款项的总额作为参数，生成支付宝按钮。
	2. 提示消费者立即确认到货。
	3. 确认到货之后，根据fop表找到fo，创建不存在的dst、dsst，把dstid写入fo，创建fodsst。

黄勇刚登记5个工时。


##28日

1. 修订基本用户协议。登记0.5工时。
2. 因为行业情况变化，打算对项目规则做较大调整。
	1. 确立现金、会员积分、成员贡献值三大指标，互相隔离。
		* 现金推动生产和物流。  
		* 现金根据比例进入消费服务费、生产服务费，转化为对应的会员服务，会员根据积分使用服务。  
		* 项目成员根据贡献值登记进入运营金的现金。
	2. 开发组、运维组的工作是：支撑物流、调节资金流、重构信息流。
	3. 规划组的工作是：识别作弊模式，行业发展不均衡导致的安全危机。提出抑制作弊或回复均衡的措施。
3. 大幅削减交易功能的复杂度，把精力拨回安全判断的形成过程。



##27日
1. 黄勇刚提交75号任务，并登记0.5工时。
2. 讨论了借助github管理文档的构想，包括日志、用户帮助、食品百科。这样可以扩大到所有用户都可以修订个人版本。
3. 由于细节需求过于繁复，提出把核心用户识别出来重点维护，确保项目的核心价值 -- 可信任的安全判断。其他跟风购买的用户，简化需求，不攀比细节。


##25日
1. 项目成员会议第一次会议.
2. 支付、对账、结账的机制还需要逐步成熟。今天提出消费者可以从支付宝一端发起退款申请，引出一些没考虑过的环节。讨论后决定：
	1. 如果退款额度是全额，则自动退款。
	2. 如果退款额度不是全额，则生成待办事项给管理员，尽可能详尽列出信息由他人工协商处理。
3. 项目日志库确定在：https://github.com/mistyworm/Food.Log
4. 王彤为第一次会议准备了会议纪要模板。

总体问题，是黄勇刚的时间没有控制好。以后要在周三前完成工作，后半周主要是讨论和对接。否则以后项目会议的效率也很难保证。
以后参加项目成员会议，应该携带计算机。或提前约定借用他人机器，把自己的账号密码记熟。
